---
title: 2. React å®žçŽ°é¡¹ç›®(åŽå°ç®¡ç†)
meta:
  - bgImage: http://pic.closeeyes.cn/react2.jpg
tag: React
---

### å‰æ²¿

ç”±äºŽæŽ¥è§¦`vue`è¾ƒå¤šï¼Œå·¥ä½œä¸­ä¹Ÿæ˜¯ç”¨`vue`åšçš„åŽå°ç®¡ç†ï¼Œæœ€è¿‘é—²ä¸‹æ¥äº†ï¼Œå°±æƒ³ç€å­¦ä¹ ä¸‹`React`ï¼Œåœ¨è¿™é‡Œè®°å½•ä¸‹åœ¨å­¦ä¹ è¿‡ç¨‹ä¸­çš„é‡åˆ°çš„é—®é¢˜ï¼Œä»¥åŠç¬”è®°ã€‚

+ é¡¹ç›®ä¸­ä¹Ÿå‚è€ƒçš„`github`ä¸­çš„é¡¹ç›®[react-admin](https://github.com/yezihaohao/react-admin)å†æ¬¡è¡¨ç¤ºå¤§å¤§çš„æ„Ÿè°¢ðŸ˜„
+ é¡¹ç›®ä¸­çš„mockæ•°æ®æ˜¯å€Ÿç”¨äº† [easy-mock](https://www.easy-mock.com/) ï¼ˆç”±äºŽæœ‰æ—¶å€™è¯·æ±‚ä¸ç¨³å®šä¹Ÿä¼šæ¢ï¼‰[fastmock](https://www.fastmock.site)ã€‚
+ åœ¨çº¿ä½“éªŒåœ°å€ [https://react.closeeyes.cn](https://react.closeeyes.cn)
+ githubå®Œæ•´ä»£ç  [ðŸ›](https://github.com/hz199/__react-admin-zh-redux)

#### 1. ç›®å½•ç»“æž„

ç”±äºŽä¹Ÿæ˜¯åˆšæŽ¥è§¦`react`å°±ç›´æŽ¥ä½¿ç”¨`create-react-app`å®˜æ–¹çš„è„šæ‰‹æž¶äº†ï¼Œç”±äºŽéœ€è¦åšä¸€äº›è‡ªå®šä¹‰é…ç½®ç›´æŽ¥`yarn eject`æŠŠwebpackç›¸å…³é…ç½®æš´éœ²å‡ºæ¥ã€‚æ•´ç†åŽçš„ç›®å½•ç»“æž„å¦‚ä¸‹å›¾ï¼š

![image](http://study.closeeyes.cn/react-admin.jpeg)

åœ¨è¿™é‡Œå°±ç®€å•ä»‹ç»ä¸‹ç›®å½•ç»“æž„
- `build`: æ‰“åŒ…ä¹‹åŽçš„ä»£ç å­˜åœ¨çš„ç›®å½•
- `config`: webpack ç›¸å…³é…ç½®
- `scripts`: webpack æ‰“åŒ…ä»¥åŠå¼€å‘å¯åŠ¨ç›®å½•
- `CNAME`: ç”±äºŽæ‰“åŒ…åŽçš„æ–‡ä»¶æ˜¯ `GitHub Pages` ç»‘å®šæ¥è‡ªé˜¿é‡Œäº‘çš„åŸŸåï¼Œåœ¨è¿™é‡Œé…ç½®ä¸‹
- `deploy.sh`: æ‰“åŒ…åŽçš„æ–‡ä»¶å‘å¸ƒåˆ° `GitHub Pages`ç›¸å…³æ“ä½œ

> `src`ç›®å½•æ˜¯æˆ‘ä»¬çš„æºä»£ç æ‰€å¤„çš„ä½ç½®

- `containers`: é¡µé¢æ‰€å¤„çš„ä½ç½®ï¼Œä¹Ÿå°±æ˜¯åŽå°ç®¡ç†çš„å†…å®¹åŒºåŸŸã€‚
- `services`: ä¸Ž`ajax`ç›¸å…³é…ç½®

#### 2. è·¯ç”±æ‹¦æˆª

æˆ‘ä»¬åšåŽå°ç®¡ç†æœ‰æ—¶å€™æƒ³è¦åœ¨è¿›å…¥é¡µé¢ä¹‹å‰åšç‚¹ä»€ä¹ˆï¼Œè¿™ä¸ªæ—¶å€™å°±ä¼šç”¨åˆ°è·¯ç”±æ‹¦æˆªï¼Œ`react-router-dom`æ²¡æœ‰åƒ`Vue-router`é‚£æ ·çš„`beforeRouter`ç”Ÿå‘½å‘¨æœŸçš„é’©å­å‡½æ•°ï¼Œé‚£å°±éœ€è¦æˆ‘ä»¬è‡ªå·±æ¥åšè¿™ä»¶äº‹æƒ…äº†ï¼Œå°è¯•äº†å¾ˆå¤šåŠžæ³•ï¼Œæ€»ç®—æ˜¯æŠŠè¿™ä¸ªäº‹æƒ…è§£å†³äº†ï¼Œå…ˆçœ‹ä»£ç ï¼š 

```js
import { asyncImport } from '../utils/routerLoadable'

const routes = [
  {
    name: 'Home',
    path: '/app',
    component: asyncImport(() => import('../containers/Home')),
    meta: {
      title: 'é¦–é¡µ',
      rules: ['loginRequired']
    }
  },
  // .......
]

export default routes
```

```js
import React from 'react'
import { Route, Switch, Redirect } from 'react-router-dom'
import routes from './api'
import queryString from 'query-string'


const Protected =  ({component: Comp, ...rest}) => {

  const { exact, path, meta, setTagPage, ...otherRest } = rest
  return (
    <Route {...rest} render={ () => {
      const { title } = rest.meta
      document.title = title || 'react-admin'

      return <Comp {...otherRest}/>
    }}/>
  )
}

const routerApp = (props) => {
  const query = queryString.parse(props.location.search)
  props.match.query = query
  return (
    <Switch>
      {
        routes.map((item) => (
          <Protected
            {...props}
            path={ item.path }
            component={ item.component }
            key={ item.path }
            exact
            meta={item.meta}>
          </Protected>
        ))
      }
      <Route render={() => <Redirect to='/404'/>} />
    </Switch>
  )
}

export default routerApp
```